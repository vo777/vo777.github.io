<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Lesson 002</title>
  <meta charset="utf-8" />
</head>

<body>
  <h3>Lesson 2</h3>
  <h4>Combinations</h4>

  <table>
    <tr><th>Who?<br>Кто?</th><th>Whom?<br>Кого? Кому?</th><th>Whose?<br>Чей?</th></tr>
    <tr><td>I</td><td>me</td><td>my</td></tr>
    <tr><td>you</td><td>you</td><td>your</td></tr>
    <tr><td>we</td><td>us</td><td>our</td></tr>
    <tr><td>they</td><td>them</td><td>their</td></tr>
    <tr><td>he</td><td>him</td><td>his</td></tr>
    <tr><td>she</td><td>her</td><td>her</td></tr>
  </table>


  <button onclick="generate()">Generate</button>
  <button onclick="read()">Read</button>
  <br>
  <input type="text" id="text1" size=100/>
  <br>
  <button onclick="generate();read()">Generate and read</button>
  <br>


  <table border=1 id="table1"></table>

  <script src="speaker.js"></script>
  <script src="data002.js"></script>

  <script>
    const parsed_data = [];
    const table1 = document.getElementById('table1');
    const text1 = document.getElementById('text1');

    parse();
    makeTable();

    function generate()
    {
      text1.value = randomSentence();
    }

    function read()
    {
      say(text1.value);
    }


    function randomSentence() {
      const data_row = parsed_data[Math.floor(parsed_data.length * Math.random())];
      let acc = '';

      for (let i=0; i<data_row.length; ++i)
      {
        acc += ' ' +
        data_row[i][Math.floor(data_row[i].length * Math.random())]
      }


      return acc;
    }

    function parse() {
      for (let split1 of data002) {
        const split2_arr = [];
        const split2 = split1.split('/');
        for (let split3 of split2) {
          const split3_arr = [];
          const split4 = split3.split('\n');

          for (let split5 of split4) {
            const tmp = split5.trim();
            console.log(tmp);
            if (tmp.length) {
              split3_arr.push(tmp);
            }
          }
          if (split3_arr.length) {
            split2_arr.push(split3_arr);
          }
        }
        if (split2_arr.length) {
          parsed_data.push(split2_arr);
        }
      }

      console.log(parsed_data);
    }


    function makeTable() {
      for (let data_row of parsed_data) {
        const row = table1.insertRow(-1);
        for (let i = 0; i < data_row.length; ++i) {
          const cell = row.insertCell(i);
          let acc = '';
          for (let j = 0; j < data_row[i].length; ++j) {
            const a = data_row[i][j];
            acc += `<span onclick='say("${a}")'>${a}</span>`;
            if (j != data_row[i].length - 1) { acc += '<br>'; }
          }
          cell.innerHTML = acc;
        }

      }

    }


  </script>

</body>

</html>