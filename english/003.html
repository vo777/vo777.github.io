<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Lesson 003</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="./styles.css">

</head>

<body>
  <h3>Lesson 3</h3>
  <h4>Continuous times + more combinations</h4>

  <table>
    <tr><th>Who?<br>Кто?</th><th>Whom?<br>Кого? Кому?</th><th>Whose?<br>Чей?</th></tr>
    <tr><td><span onclick="say('I')">I</span></td>
      <td><span onclick="say('me')">me</span></td>
      <td><span onclick="say('my')">my</span></td></tr>
    <tr><td><span onclick="say('you')">you</span></td>
      <td><span onclick="say('you')">you</span></td>
      <td><span onclick="say('your')">your</span></td></tr>
    <tr><td><span onclick="say('we')">we</span></td>
      <td><span onclick="say('us')">us</span></td>
      <td><span onclick="say('our')">our</span></td></tr>
    <tr><td><span onclick="say('they')">they</span></td>
      <td><span onclick="say('them')">them</span></td>
      <td><span onclick="say('their')">their</span></td></tr>
    <tr><td><span onclick="say('he')">he</span></td>
      <td><span onclick="say('him')">him</span></td>
      <td><span onclick="say('his')">his</span></td></tr>
    <tr><td><span onclick="say('she')">she</span></td>
      <td><span onclick="say('her')">her</span></td>
      <td><span onclick="say('her')">her</span></td></tr>
  </table>


  <button onclick="generate()">Generate</button>
  <button onclick="read()">Say</button>
  <br>
  <input type="text" id="text1" size=100/>
  <br>
  <button onclick="generate();read()">Generate and say</button>
  <br>


  <table id="table1"></table>

  <script src="speaker.js"></script>
  <script src="data003.js"></script>

  <script>
    const parsed_data = [];
    const table1 = document.getElementById('table1');
    const text1 = document.getElementById('text1');

    parse();
    makeTable();

    function generate()
    {
      text1.value = randomSentence();
    }

    function read()
    {
      say(text1.value);
    }


    function randomSentence() {
      const data_row = parsed_data[Math.floor(parsed_data.length * Math.random())];
      let acc = '';

      for (let i=0; i<data_row.length; ++i)
      {
        acc += data_row[i][Math.floor(data_row[i].length * Math.random())] + ', ';
      }


      return acc;
    }

    function parse() {
      for (let split1 of data003) {
        const split2_arr = [];
        const split2 = split1.split('/');
        for (let split3 of split2) {
          const split3_arr = [];
          const split4 = split3.split('\n');

          for (let split5 of split4) {
            const tmp = split5.trim();
            console.log(tmp);
            if (tmp.length) {
              split3_arr.push(tmp);
            }
          }
          if (split3_arr.length) {
            split2_arr.push(split3_arr);
          }
        }
        if (split2_arr.length) {
          parsed_data.push(split2_arr);
        }
      }

      console.log(parsed_data);
    }


    function makeTable() {
      for (let data_row of parsed_data) {
        const row = table1.insertRow(-1);
        for (let i = 0; i < data_row.length; ++i) {
          const cell = row.insertCell(i);
          let acc = '';
          for (let j = 0; j < data_row[i].length; ++j) {
            const a = data_row[i][j];
            acc += `<span onclick='say("${a}")'>${a}</span>`;
            if (j != data_row[i].length - 1) { acc += '<br>'; }
          }
          cell.innerHTML = acc;
        }

      }

    }


  </script>

</body>

</html>